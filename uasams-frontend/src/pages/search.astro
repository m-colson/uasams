---
export const prerender = false;

import FilterBar from "../components/FilterBar.astro";
import Seperator from "../components/Seperator.astro";
import ShortScholarship from "../components/ShortScholarship.astro";
import ShortScholarshipList from "../components/ShortScholarshipList.astro";
import Layout from "../layouts/Layout.astro";

// const queryString = Astro.url.searchParams.get("q");
// const availablity = Astro.url.searchParams.get("av");
const page = Astro.url.searchParams.get("page");

const pageNum = parseInt(page ?? "1");

const results = await Astro.locals.pb
    .collection("scholarships")
    .getList(pageNum, 50, {
        filter: "deadline > @now",
        sort: "deadline",
    });

const items = results.items;
---

<Layout title="Search - SAMS">
    <FilterBar totalPages={results.totalPages} />
    <ShortScholarshipList items={items} />
</Layout>
